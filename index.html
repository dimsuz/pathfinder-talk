<!doctype html>
<html>
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

      <title>Pathfinder</title>

      <link rel="stylesheet" href="dist/reset.css">
      <link rel="stylesheet" href="dist/reveal.css">
      <link rel="stylesheet" href="dist/theme/black.css" id="theme">

      <!-- Theme used for syntax highlighted code -->
      <link rel="stylesheet" href="plugin/highlight/zenburn.css" id="highlight-theme">
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                  <h3>Pathfinder</h3>
                  <p style="font-size: 0.7em;">Помощник в построении URL</p>
                  <p style="margin: 0;">
                    <img style=" margin: 0; margin-right: auto; margin-left:auto; display: block;" src="images/dall-e-logo.jpg" width="350">
                    <span style="font-size: 0.4em; font-style: italic;">(лого по версии DALL-E)</cite>
                  </p>
                </section>
                <section>
                  <h3>Анатомия URL (в проекте)</h3>
                  <p class="fragment hljs-number">https://api.project.ru/v1/{categoryId}/users?sort=name</p>
                </section>
                <section>
                  <p>https://api.project.ru/v1/<span style="opacity: 0.2;">{categoryId}/users?sort=name</span></p>
                  <p class="fragment hljs-number">baseUrl</p>
                  <p class="fragment fade-in-then-semi-out">ServerConfig(baseUrl = "https://api.project.ru/v1/")</p>
                  <p class="fragment fade-in-then-semi-out">Складывается в репозиторий/persistance на старте</p>
                  <p class="fragment fade-in-then-semi-out">Скармливается Retrofit при его инициализации</p>
                  <p class="fragment">Меняется через дебаг панель</p>
                </section>
                <section data-transition="slide-in fade-out">
                  <p><span style="opacity: 0.2;">https://api.project.ru/v1/</span>{categoryId}<span style="opacity: 0.2;">/users?sort=name</span></p>
                  <p class="fragment hljs-number">Path-параметр</p>
                  <p class="fragment fade-in-then-semi-out">Задаётся через Retrofit <span class="hljs-number">@Path</span></p>
                  <p class="fragment fade-in-then-semi-out">Конфигурируется в <span class="hljs-number">ProjectApi.kt</span>-файлах</p>
                  <p class="fragment fade-in-then-semi-out">Фактическое значение передаётся из Repository</p>
                  <p class="fragment"><s>Меняется через дебаг панель</s></p>
                </section>
                <section data-transition="fade-in slide-out">
                  <p><span style="opacity: 0.2;">https://api.project.ru/v1/{categoryId}/users</span>?sort=name</p>
                  <p class="fragment hljs-number">Query-параметр</p>
                  <p class="fragment fade-in-then-semi-out">Задаётся через Retrofit <span class="hljs-number">@Query</span></p>
                  <p class="fragment fade-in-then-semi-out">Конфигурируется в <span class="hljs-number">ProjectApi.kt</span>-файлах</p>
                  <p class="fragment fade-in-then-semi-out">Фактическое значение передаётся из Repository</p>
                  <p class="fragment"><s>Меняется через дебаг панель</s></p>
                </section>
                <section data-transition="slide-in fade-out">
                  <img src="images/spotlight.jpg">
                </section>
                <section data-transition="fade-in slide-out">
                  <div style="position: relative; text-align: center">
                    <img src="images/spotlight.jpg">
                    <h3 style="position:absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); margin-top: 16px;">Pathfinder</h3>
                  </div>
                </section>
                <section>
                  <h3>Pathfinder</h3>
                  <p>Библиотека для конфигурации URL-ов</p>
                  <p class="fragment"><strong>Только</strong> URL</p>
                  <p class="fragment">&#128683; Headers</p>
                  <p class="fragment">&#128683; POST Body</p>
                  <p class="fragment">&#128683; Ktor, OkHttpClient, Retrofit</p>
                  <p class="fragment">&#9989; URL</p>
                </section>
                <section>
                  <h3>API</h3>
                  <pre>
                    <code data-trim data-noescape class="kotlin">
                      // in Application.kt
                      val pathFinder = PathFinder(
                        environments = listOf(server1, server2),
                        urls = listOf(
                          UrlSpec(id = uuid1, "/{categoryId}/users"),
                          UrlSpec(id = uuid2, "/list/{userId}")
                        )
                      )
                    </code>
                  </pre>
                </section>
                <section>
                  <h3>API</h3>
                  <pre>
                    <code data-trim data-noescape class="kotlin">
                      // in Repository.kt
                      val url: String = pathFinder.buildUrl(
                        urlSpec1.id,
                        mapOf("categoryId" to "485")
                      )

                      // url = "https://mock.product.ru/api/v1/485/users"
                    </code>
                  </pre>
                </section>
                <section>
                  <h3>API</h3>
                  <pre>
                    <code data-trim data-noescape class="kotlin">
                      interface NetworkApi {
                        // Было
                        @GET("{categoryId}/users")
                        suspend fun fetchUsers(@Path categoryId: String): Users

                        // Стало
                        @GET
                        suspend fun fetchUsers(@Url url: String): Users
                      }
                    </code>
                  </pre>
                </section>
                <section>
                  <h3>API</h3>
                  <pre>
                    <code data-trim data-noescape class="kotlin">
                      interface NetworkApi {
                        @POST
                        @Header("Authorization: Bearer grizly")
                        suspend fun updateUser(
                          @Url url: String,
                          @Body requestBody: UpdateRequest
                        )
                      }
                    </code>
                  </pre>
                </section>
                <section>
                  <section>
                    <pre>
                      <code data-trim data-noescape class="kotlin">
                        sealed class ContentState {
                            object None : ContentState()
                            object Loading : ContentState()
                            object Ready : ContentState()
                            data class Error(error: Throwable) : ContentState()
                        }
                      </code>
                    </pre>
                    <div class="r-stack">
                      <p class="fragment fade-in-then-out">
                        Algebraic?<br>
                        <img src="images/finn_thinking1.webp" height="200">
                      </p>
                      <p class="fragment current-visible">
                        Yussss!<br>
                        <img src="images/finn_yuss1.jpg" height="200">
                      </p>
                    </div>
                  </section>
                  <section>
                    <pre>
                      <code data-trim data-noescape class="kotlin">
                        data class AccountApplicationSM(
                          val userId: String,
                          val id: String,
                          val amount: Money?,
                          val status: ProductStatus.AccountApplicationStatus,
                          val number: String
                        )
                      </code>
                    </pre>
                    <div class="r-stack">
                      <p class="fragment fade-in-then-out">
                        Algebraic?<br>
                        <img src="images/finn_thinking2.jpg" height="200">
                      </p>
                      <p class="fragment current-visible">
                        Yussss!<br>
                        <img src="images/finn_yuss2.webp" height="200">
                      </p>
                    </div>
                  </section>
                  <section>
                    <pre>
                      <code data-trim data-noescape class="kotlin" style="font-size: 0.7em; line-height: 1.5em;">
                        class BottomSheetSearchSelectorDialog {
                          private var epoxyController: BottomSheetSearchSelectorEpoxyController? = null
                          private var dialog: BottomSheetDialog? = null

                          fun show() { dialog?.show() }

                          fun dismiss() {
                            hideKeyboard(dialog?.window?.decorView)
                            dialog?.dismiss()
                          }
                        }
                      </code>
                    </pre>
                    <div class="r-stack">
                      <p class="fragment fade-in-then-out">
                        Algebraic?<br>
                        <img src="images/finn_thinking3.png" height="200">
                      </p>
                      <p class="fragment current-visible">
                        Эммммм...<br>
                        <img src="images/finn_kinda.webp" height="200">
                      </p>
                    </div>
                  </section>
                </section>
                <section>
                  <h3>Причём здесь алгебра?</h3>
                  <p class="fragment">Похожие операции</p>
                  <p class="fragment">Мат. нотация используется в теории типов (создание ЯП) для их записи</p>
                </section>
                <section>
                  <h3>Игра</h3>
                </section>
                <section>
                  <section>
                    <h5>
                      <span class="hljs-title">«Сколько можно создать уникальных значений этого типа?»</span>
                    </h5>
                    <table>
                      <tr>
                        <td><span class="fragment">Nothing</span></td>
                        <td><span class="fragment hljs-number">0</span></td>
                      </tr>
                      <tr>
                        <td><span class="fragment">Unit</span></td>
                        <td><span class="fragment hljs-number">1</span></td>
                      </tr>
                      <tr>
                        <td><span class="fragment">Boolean</span></td>
                        <td><span class="fragment hljs-number">2</span></td>
                      </tr>
                    </table>
                  </section>
                  <section>
                    <pre>
                      <code data-trim data-noescape class="kotlin">
                        sealed class Boolean {
                          object True : Boolean()
                          object False : Boolean()
                        }
                      </code>
                    </pre>
                  </section>
                  <section>
                    <h5>
                      <span class="hljs-title">«Сколько можно создать уникальных значений этого типа?»</span>
                    </h5>
                    <table>
                      <tr>
                        <td><span class="">Nothing</span></td>
                        <td><span class="hljs-number">0</span></td>
                      </tr>
                      <tr>
                        <td><span class="">Unit</span></td>
                        <td><span class="hljs-number">1</span></td>
                      </tr>
                      <tr>
                        <td><span class="">Boolean</span></td>
                        <td><span class="hljs-number">1 + 1</span></td>
                      </tr>
                    </table>
                  </section>
                  <section>
                    <pre>
                      <code data-trim data-noescape class="kotlin">
                        sealed class Answer {
                          object Yes : Answer()
                          object No : Answer()
                          object NotSure : Answer()
                        }
                      </code>
                    </pre>
                    <p class="fragment hljs-number">1 + 1 + 1 = 3</p>
                    <p class="fragment">и так далее (<span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>)...</p>
                  </section>
                  <section>
                    <pre>
                      <code data-trim data-noescape class="kotlin">
                        sealed class Optional&lt;A&gt; {
                          object None : Optional&lt;Nothing&gt;()
                          data class Some&lt;A&gt;(value: A)  : Optional&lt;A&gt;()
                        }
                      </code>
                    </pre>
                    <p>
                      <span class="fragment hljs-number">1</span>
                      <span class="fragment hljs-number"> + A</span>
                    </p>
                    <p class="fragment">«+» читается как «или»</p>
                  </section>
                  <section>
                    <pre>
                      <code data-trim data-noescape class="kotlin">
                        sealed class Either&lt;A, B&gt; {
                          data class Left&lt;A&gt;(value: A) : Either&lt;A, Nothing&gt;()
                          data class Right&lt;B&gt;(value: B) : Either&lt;Nothing, B&gt;()
                        }
                      </code>
                    </pre>
                    <p>
                      <span class="fragment hljs-number">A</span>
                      <span class="fragment hljs-number"> + B</span>
                    </p>
                  </section>
                  <section>
                    <pre>
                      <code data-trim data-noescape class="kotlin">
                        data class Pair&lt;A, B&gt;(
                          val first: A,
                          val second: B
                        )
                      </code>
                    </pre>
                    <p class="fragment">Если A=Answer, B=Boolean</p>
                    <p class="fragment hljs-title">(Yes, True) (Yes, False)</p>
                    <p class="fragment hljs-title">(No, True) (No, False)</p>
                    <p class="fragment hljs-title">(NotSure, True) (NotSure, False)</p>
                    <p>
                      <span class="fragment hljs-number">3 × 2 = 6</span>
                      <span class="fragment hljs-number">⇒ A × B</span>
                    </p>
                  </section>
                  <section>
                    <pre>
                      <code data-trim data-noescape class="kotlin">
                        data class Triple&lt;A, B, C, D&gt;(
                          val first: A,
                          val second: B,
                          val third: Either&lt;C, D&gt;
                        )
                      </code>
                    </pre>
                    <p>
                      <span class="fragment hljs-number">A</span>
                      <span class="fragment hljs-number"> × B</span>
                      <span class="fragment hljs-number"> × (C + D)</span>
                    </p>
                    <p class="hljs-template-tag" style="font-size: 0.7em;">
                      <span class="fragment">(что будет если раскрыть скобки?...)</span>
                    </p>
                  </section>
                  <section>
                    <pre>
                      <code data-trim data-noescape class="kotlin">
                        sealed class Either&lt;A, B, C, D&gt; {
                          data class Left(value: Pair&lt;A, B&gt;) : Either&lt;...&gt;()
                          data class Right(value: Pair&lt;C, D&gt;) : Either&lt;...&gt;()
                        }
                      </code>
                    </pre>
                    <p>
                      <span class="fragment hljs-number">(A × B) + (C × D)</span>
                    </p>
                  </section>
                  <section>
                    <pre>
                      <code data-trim data-noescape class="kotlin">
                        fun callMe(a: A): B
                        // или
                        val callMe: (A) -> B
                      </code>
                    </pre>
                    <p>
                      <span class="fragment hljs-number">B<sup>A</sup></span>
                    </p>
                  </section>
                </section>
                <section>
                  <h3>«Зачем <span class="hljs-number">мне</span> это знать?»</h3>
                  <img src="images/whatever.jpg" height="300">
                </section>
                <section>
                  <img src="images/shrug.svg" height="300">
                </section>
                <section>
                  <ul>
                    <li>Интересно (теория + фундамент)</li>
                    <li class="fragment">Терминология: «sum types», «product types», «union types»</li>
                    <li class="fragment">Влияние на дизайн и фичи языков программирования (Java, Kotlin, Typescript, Dart)</li>
                  </ul>
                </section>
                <section>
                  <h3>Ссылки</h3>
                  <ul>
                    <li>Исходники презы:<br>
                      <a href="https://github.com/dimsuz/adt-talk">https://github.com/dimsuz/adt-talk</a></li>
                    <li>Статья <span class="hljs-title">by Joel Burget</span> про ADT (+ ряд тейлора, zippers, дифференцирование)<br>
                      <a href="https://codewords.recurse.com/issues/three/algebra-and-calculus-of-algebraic-data-types">https://codewords.recurse.com/issues/three/algebra-and-calculus-of-algebraic-data-types</a>
                    </li>
                  </ul>
                </section>
            </div>
        </div>

        <script src="dist/reveal.js"></script>
        <script src="plugin/notes/notes.js"></script>
        <script src="plugin/markdown/markdown.js"></script>
        <script src="plugin/highlight/highlight.js"></script>
        <script>
            // More info about initialization & config:
            // - https://revealjs.com/initialization/
            // - https://revealjs.com/config/
            Reveal.initialize({
                hash: true,
                width: 1024,

                // Learn about plugins: https://revealjs.com/plugins/
                plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
            });
        </script>
    </body>
</html>
